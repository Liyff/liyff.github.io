# Linux系统编程

![image-20250615193853491](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615193853491.png)

man man帮助手册

man 2 fopen()

注意：

- 指针类型的返回值,主调函数需要释放内存

- 系统调用返回值不实现功能，只用来处理报错
- 指针类型的参数，主调函数开辟空间

## 文件

文件类型：

1. 普通文件
2. 目录文件
3. 软链接
4. 字符设备文件    鼠标
5. 块设备文件        磁盘
6. 管道文件            通信
7. socket                网络



全局变量 errno   ->perror();

## fopen(path,mode)

![image-20250615215516762](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615215516762.png)

库函数

```
FILE* fp = fopen(argv[1],”a+”);

mode:
	"a"  只写追加-》默认从文件结尾写入
	"a+" 读写追加  打开时ptr处于文件开始base，写入时处于文件结尾
日志系统

追加模式打开文件：

fread(buf,1,1024,fp);
puts(buf);
fseek(fp,0,SEEK_SET);//fp.ptr移到开头
printf("loc=%ld",ftell(fp));//打印fp.ptr指向位置
fwrite("hello",1,1024,fp);//追加模式，ptr还是处于末尾写入
```

![image-20250615220756857](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615220756857.png)

## chmod(path,mode_t)

修改目录权限

```

```













strlen()读到第一个为零位置结束

read 磁盘文件 读到字节<=count,每次read,pos后移，若缓冲区无数据，返回0读完，

read 设备文件 若缓冲区无数据，进程陷入阻塞，ctrl+d文件终止，阻塞不占用cpu

读写二进制文件

![image-20250614172233281](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250614172233281.png)

![image-20250614173410041](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250614173410041.png)

fread/fwrite对比read/write

![image-20250614174646905](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250614174646905.png)

文件映射 mmap

![image-20250614182252658](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250614182252658.png)

lseek

![image-20250614183907920](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250614183907920.png)

FILE和文件对象





![image-20250615155615785](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615155615785.png)



重定向

重定向stdout，更改1号fd引用的文件对象







dup复制文件描述符 选择最小可用文件描述符

![image-20250615162719642](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615162719642.png)

![image-20250615163934427](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615163934427.png)

![image-20250615164331906](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615164331906.png)

有名管道

mkfifo 	1.pipe  创建管道  文件大小永远是0

一读一写，两端都执行，只执行一端会阻塞

open会引发阻塞，等到对端也被open了，才会恢复就绪

![image-20250615171952353](C:\Users\LIYUFENG\AppData\Roaming\Typora\typora-user-images\image-20250615171952353.png)

